<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Spookytime AI Rotation (Demo)</title>
  <style>
    body { background:#000; color:#66ffcc; font-family:monospace; text-align:center; }
    #canvas { background:#111; border:2px solid #66ffcc; display:block; margin:20px auto; }
    #chat { width:500px; height:200px; margin:20px auto; background:#050505;
            border:1px solid #333; overflow-y:auto; text-align:left; padding:5px; }
    .msg { margin:2px 0; }
    .sys { color:#aaa; }
    .ai { color:#66ffcc; }
  </style>
</head>
<body>
  <h1>üåÄ Spookytime AI Rotation (Hitbox Demo)</h1>
  <canvas id="canvas" width="500" height="400"></canvas>
  <div id="chat"></div>

<script>
const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");
const chat=document.getElementById("chat");

// —Ü–µ–ª—å (—Ö–∏—Ç–±–æ–∫—Å)
const target={x:250,y:200,width:80,height:120};

// –¥–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —á–∞—Ç
function addMsg(txt,cls="ai") {
  const div=document.createElement("div");
  div.className="msg "+cls;
  div.textContent=txt;
  chat.appendChild(div);
  chat.scrollTop=chat.scrollHeight;
}

// –¥–æ–±–∞–≤–ª—è–µ–º —Å–∏—Å—Ç–µ–º–Ω–æ–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
addMsg("[–°–∏—Å—Ç–µ–º–∞] –ó–∞–ø—É—Å–∫ SpookytimeAI...", "sys");

let angle=0;

function loop(){
  ctx.clearRect(0,0,500,400);

  // —Ö–∏—Ç–±–æ–∫—Å
  ctx.strokeStyle="red";
  ctx.strokeRect(target.x-target.width/2, target.y-target.height/2,
                 target.width,target.height);

  const cx=target.x;
  const cy=target.y;

  // –ª–æ–≥–∏–∫–∞: —Ä–∞–¥–∏—É—Å —Ä—è–¥–æ–º —Å —Ö–∏—Ç–±–æ–∫—Å–æ–º
  const radius=target.width/2+20; 
  angle+=(2*Math.PI)/200; // —Å–∫–æ—Ä–æ—Å—Ç—å

  const offX=Math.cos(angle)*radius;
  const offZ=Math.sin(angle)*radius;
  const offY=(target.height*0.5)-target.height*0.25;

  const aimX=cx+offX;
  const aimY=cy+offY; // —É–ø—Ä–æ—â–µ–Ω–Ω–æ, –±–µ—Ä—ë–º 2D

  // —Ä–∏—Å—É–µ–º –ø—Ä–∏—Ü–µ–ª
  ctx.fillStyle="#66ffcc";
  ctx.beginPath();
  ctx.arc(aimX,aimY,8,0,Math.PI*2);
  ctx.fill();

  // –ª–∏–Ω–∏—è –∫ —Ü–µ–Ω—Ç—Ä—É
  ctx.strokeStyle="#66ffcc";
  ctx.beginPath();
  ctx.moveTo(cx,cy);
  ctx.lineTo(aimX,aimY);
  ctx.stroke();

  // —Å—á–∏—Ç–∞–µ–º yaw/pitch (—É–ø—Ä–æ—â–µ–Ω–Ω–æ 2D –≤–µ—Ä—Å–∏—è –¥–ª—è —Å–∞–π—Ç–∞)
  let dx=aimX-cx;
  let dy=aimY-cy;
  let yaw=(Math.atan2(-dx,radius)*180/Math.PI).toFixed(2);
  let pitch=(Math.atan2(-dy,radius)*180/Math.PI).toFixed(2);

  // –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã ‚Üí ¬´–ø–æ–¥—Å–∫–∞–∑–∫–∞ –≤ —á–∞—Ç¬ª
  if (Date.now()%2000 < 30) {
    addMsg(`[Spookytime AI] —Ü–µ–ª—å –≤ —Ä–∞–¥–∏—É—Å–µ —Ö–∏—Ç–±–æ–∫—Å–∞ (Yaw=${yaw}¬∞, Pitch=${pitch}¬∞) ‚Üí –±–µ–π!`);
  }

  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
